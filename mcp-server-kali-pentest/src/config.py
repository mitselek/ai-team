"""Configuration module for MCP Kali Pentest server."""

import os
from typing import List

class Config:
    """Server configuration from environment variables."""
    
    # Docker configuration
    DOCKER_IMAGE: str = os.getenv("KALI_DOCKER_IMAGE", "kalilinux/kali-rolling")
    CONTAINER_USER: str = os.getenv("CONTAINER_USER", "kali")
    
    # Security configuration
    ALLOWED_NETWORKS: List[str] = os.getenv(
        "ALLOWED_NETWORKS", 
        "127.0.0.1,localhost"
    ).split(",")
    
    # Server configuration
    LOG_LEVEL: str = os.getenv("LOG_LEVEL", "INFO")
    MAX_TIMEOUT: int = int(os.getenv("MAX_TIMEOUT", "300"))
    
    # Optional WPScan API token
    WPSCAN_API_TOKEN: str = os.getenv("WPSCAN_API_TOKEN", "")
    
    @classmethod
    def validate(cls) -> None:
        """Validate configuration on startup."""
        if not cls.ALLOWED_NETWORKS:
            raise ValueError("ALLOWED_NETWORKS must not be empty")
        
        if cls.MAX_TIMEOUT < 30:
            raise ValueError("MAX_TIMEOUT must be at least 30 seconds")


# Validate config on import
Config.validate()
